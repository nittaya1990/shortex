%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  shortex.sty
%%  Latex packages and macros for
%%  more efficient, readable math
%%
%%  Copyright (c) 2023 Trevor Campbell
%%  Adapted from original style files
%%  by Jonathan Huggins, Dan Roy, Ryan Adams
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Package Imports
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{xifthen} % extended if/then commands (needed internally for \isempty)
\usepackage{xstring} % string manipulation (needed internally for \StrLeft, \StrGobbleLeft, \IfStrEqCase, etc in font/style macro expansions)
\usepackage{xspace} % defines \xspace command that automatically determine whether spaces should be eaten (needed internally for many defns)
\usepackage{xargs} % more flexible \newcommand etc for multiple optional arguments (TODO: is this needed?)
\usepackage[usenames]{color} % for using colored text (needed internally for \definecolor to create WowColor and SubtleColor)
\usepackage{hyperref} % typical linking package
\usepackage{mathrsfs,dsfont,amsmath,amssymb,amsthm,bm,bbm,amsfonts,mathtools,thmtools} % math
\usepackage[nice]{nicefrac} % nice fraction typesetting
\usepackage[capitalize,sort,compress]{cleveref} % automatic typesetting of references with typed names
\usepackage{crossreftools} % ensure that crefs appear correctly in bookmarks (needed internally for \crtCref, \crtcref)
\usepackage{algpseudocode, algorithm} % typical algorithm typesetting packages
\usepackage{graphicx} % typical graphics package for figures
\usepackage{multirow} % multirow tables
\usepackage{wrapfig} % figures wrapped into the text
\usepackage{caption,subcaption} % package for sub-environments (figs, tables, etc)
\usepackage{microtype} % microtypesetting improvements for latex
\usepackage{booktabs} % professional quality tables
\usepackage{import, subfiles} % packages for using subfile/folder structure
\usepackage{url} % nice URL typesetting (used internally for \UrlFont command)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Color Definitions 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\definecolor{WowColor}{rgb}{.75,0,.75}
\definecolor{SubtleColor}{rgb}{0,0,.50}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Package Option Declarations and Processing
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%hyperref format/color/etc
\DeclareOption{colorhypersetup}{\hypersetup{colorlinks=true, allcolors=SubtleColor, pdfborder={0 0 0}}}
\DeclareOption{blackhypersetup}{\hypersetup{colorlinks=false, allcolors=black, pdfborder={0 0 0}}}
\def\boldorbar{\bar}
\DeclareOption{bbold}{\def\boldorbar{\bm}}
\DeclareOption{bbar}{\def\boldorbar{\bar}}
%autonum
\newif\ifuseautonum
\useautonumfalse
\DeclareOption{autonum}{\useautonumtrue}
\ProcessOptions
\ifuseautonum \usepackage{autonum} \fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Bookmarks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ensures that hyperref generates correct 
% bookmarks when using cleveref
\pdfstringdefDisableCommands{%
    \let\Cref\crtCref
    \let\cref\crtcref
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Commenting 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcounter{margincounter}
\newcommand{\displaycounter}{{\arabic{margincounter}}}
\newcommand{\incdisplaycounter}{{\stepcounter{margincounter}\arabic{margincounter}}}

% inline comments
\newcommand{\RMK}[1]{\textcolor{SubtleColor}{ {\tiny \bf (!)} #1}} % a general comment (subtle color)
\newcommand{\PRB}[1]{\textcolor{WowColor}{ {\bf (!!)} {\bf #1}}} % a problem (wow color)
% margin comments
\newcommand{\mRMK}[1]{\textcolor{SubtleColor}{$\,^{(\incdisplaycounter)}$}\marginpar{\tiny\textcolor{SubtleColor}{ {\tiny $(\displaycounter)$} #1}}}
\newcommand{\mPRB}[1]{\textcolor{WowColor}{$\,^{((\incdisplaycounter))}$}\marginpar{\tiny\textcolor{WowColor}{ {\bf $\mathbf{((\displaycounter))}$} {\bf #1}}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% URLs
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand*{\UrlFont}{\ttfamily\scriptsize\relax}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Algorithms %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Fix the \Comment command
\algrenewcommand{\algorithmiccomment}[1]{\hfill$\triangleright$ #1} 

%properly indented comments
%usage:
%\LineComment{X}{Here is the comment},  where X = # additional indents. 
%right after for / procedure / function calls, for whatever reason need to indent manually...
\newdimen{\algindent}
\setlength\algindent{1.5em}
\makeatletter
\newcommand{\LineComment}[2][0]{\Statex \hspace{#1\algindent} \hskip\ALG@thistlm $\triangleright$ #2}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List Environments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\bitems}{\begin{itemize}}
\newcommand{\eitems}{\end{itemize}}
\newcommand{\benum}{\begin{enumerate}}
\newcommand{\eenum}{\end{enumerate}}
\newcommand{\bdesc}{\begin{description}}
\newcommand{\edesc}{\end{description}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Math Environments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\AtBeginDocument{ %necessary to stop clash with autonum package
\def\[#1\]{\begin{align}#1\end{align}}		% numbered
\def \<#1\>{\begin{aligned}#1\end{aligned}}
\def\(#1\){\begin{align*}#1\end{align*}} 	% unnumbered
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Proof Environments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\bprf}{\begin{proof}}
\newcommand{\eprf}{\end{proof}}
\newenvironment{proofof}[1]{\renewcommand{\proofname}{Proof of #1}\proof}{\endproof}
\newcommand{\bprfof}{\begin{proofof}}
\newcommand{\eprfof}{\end{proofof}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Theorem-like environments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% numbered
\declaretheorem[name=Theorem,numberwithin=section]{theorem}
\declaretheorem[name=Lemma,numberlike=theorem]{lemma}
\declaretheorem[name=Proposition,numberlike=theorem]{proposition}
\declaretheorem[name=Corollary,numberlike=theorem]{corollary}
\declaretheorem[name=Conjecture,numberlike=theorem]{conjecture}
\declaretheorem[name=Definition,numberlike=theorem]{definition}
\declaretheorem[name=Assumption,numberlike=theorem]{assumption}
\declaretheorem[qed=$\triangleleft$,name=Example,numberlike=theorem]{example}
\declaretheorem[qed=$\triangleleft$,name=Remark,numberlike=theorem]{remark}
\declaretheorem[qed=$\triangleleft$,name=Fact,numberlike=theorem]{fact}
\declaretheorem[qed=$\square$,name=Exercise,numberwithin=section]{exercise}

% unnumbered
\declaretheorem[name=Theorem,numbered=no]{theorem*}
\declaretheorem[name=Lemma,numbered=no]{lemma*}
\declaretheorem[name=Proposition,numbered=no]{proposition*}
\declaretheorem[name=Corollary,numbered=no]{corollary*}
\declaretheorem[name=Conjecture,numbered=no]{conjecture*}
\declaretheorem[name=Definition,numbered=no]{definition*}
\declaretheorem[name=Assumption,numbered=no]{assumption*}
\declaretheorem[qed=$\triangleleft$,name=Example,numbered=no]{example*}
\declaretheorem[qed=$\triangleleft$,name=Remark,numbered=no]{remark*}
\declaretheorem[qed=$\triangleleft$,name=Fact,numbered=no]{fact*}
\declaretheorem[qed=$\square$,name=Exercise,numbered=no]{exercise*}

% numbered shorthands
\long\def\bthm#1\ethm{\begin{theorem}#1\end{theorem}}
\long\def\blem#1\elem{\begin{lemma}#1\end{lemma}}
\long\def\bprop#1\eprop{\begin{proposition}#1\end{proposition}}
\long\def\bcor#1\ecor{\begin{corollary}#1\end{corollary}}
\long\def\bconj#1\econj{\begin{conjecture}#1\end{conjecture}}
\long\def\bdef#1\edef{\begin{definition}#1\end{definition}}
\long\def\bassump#1\ebassump{\begin{assumption}#1\end{assumption}}
\long\def\bexa#1\eexa{\begin{example}#1\end{example}}
\long\def\brmk#1\ermk{\begin{remark}#1\end{remark}}
\long\def\bfact#1\efact{\begin{fact}#1\end{fact}}
\long\def\bexer#1\eexer{\begin{exercise}#1\end{exercise}}

% unnumbered shorthands
\def\bthmu#1\ethmu{\begin{theorem*}#1\end{theorem*}}
\def\blemu#1\elemu{\begin{lemma*}#1\end{lemma*}}
\def\bpropu#1\epropu{\begin{proposition*}#1\end{proposition*}}
\def\bcoru#1\ecoru{\begin{corollary*}#1\end{corollary*}}
\def\bconju#1\econju{\begin{conjecture*}#1\end{conjecture*}}
\def\bdefu#1\edefu{\begin{definition*}#1\end{definition*}}
\def\bassumpu#1\ebassumpu{\begin{assumption*}#1\end{assumption*}}
\def\bexau#1\eexau{\begin{example*}#1\end{example*}}
\def\brmku#1\ermku{\begin{remark*}#1\end{remark*}}
\def\bfactu#1\efactu{\begin{fact*}#1\end{fact*}}
\def\bexeru#1\eexeru{\begin{exercise*}#1\end{exercise*}}

% cleveref names
\crefname{theorem}{Theorem}{Theorems}
\crefname{lemma}{Lemma}{Lemmas}
\crefname{proposition}{Proposition}{Propositions}
\crefname{corollary}{Corollary}{Corollaries}
\crefname{conjecture}{Conjecture}{Conjectures}
\crefname{definition}{Definition}{Definitions}
\crefname{assumption}{Assumption}{Assumptions}
\crefname{example}{Example}{Examples}
\crefname{remark}{Remark}{Remarks}
\crefname{fact}{Fact}{Facts}
\crefname{exercise}{Exercise}{Exercises}
\crefformat{footnote}{#1\footnotemark[#2]#3}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Bracket Shorthands %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Brackets and bracket-like functions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\DeclarePairedDelimiter\rbra{(}{)}
\DeclarePairedDelimiter\cbra{\{}{\}}
\DeclarePairedDelimiter\sbra{[}{]}

\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\card{\lvert}{\rvert}
\DeclarePairedDelimiter\set{\{}{\}}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}
\DeclarePairedDelimiterXPP\normsub[2]{}{\lVert}{\rVert}{_{#2}}{#1}
\DeclarePairedDelimiterX\inner[2]{\langle}{\rangle}{#1,#2}
\DeclarePairedDelimiterXPP\innersub[3]{}{\langle}{\rangle}{_{#3}}{#1,#2}


%%%%%%%%%%%%%%%%%%%%%%
%%% Important Sets %%%
%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\reals}{\ensuremath{\mathbb{R}}}
\newcommand{\extReals}{\overline{\reals}}
\newcommand{\posReals}{\reals_+}
\newcommand{\posExtReals}{{\overline\reals}_+}
\newcommand{\posPosReals}{\reals_{++}}
\newcommand{\posPosExtReals}{{\overline\reals}_{++}}

\newcommand{\ints}{\ensuremath{\mathbb{Z}}}
\newcommand{\posInts}{\ints_+}

\newcommand{\rats}{\ensuremath{\mathbb{Q}}}
\newcommand{\posRats}{\rats_+}

\newcommand{\nats}{\ensuremath{\mathbb{N}}}
\newcommand{\natsO}{\nats_{0}}

\newcommand{\comps}{\ensuremath{\mathbb{C}}}

\newcommand{\measures}{\mathcal{M}}
\newcommand{\probMeasures}{\mathcal{M}_1}


% Set Operations
%%%%%%%%%%%%%%%%
\newcommand{\PowerSet}{\mathcal{P}}

\newcommand{\union}{\cup}
\newcommand{\Union}{\bigcup}
\newcommand{\djunion}{\sqcup}
\newcommand{\djUnion}{\bigsqcup}

\newcommand{\intersect}{\cap}
\newcommand{\Intersect}{\bigcap}

\newcommand{\vol}{\operatorname{vol}}
\newcommand{\diam}{\operatorname{diam}}
\newcommand{\closure}{\operatorname{cl}}
\newcommand{\spann}{\operatorname{span}}

\newcommand{\boundary}{\partial}


%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Vectors & Matrices %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\bone}{\mathbf{1}}
\newcommand{\bzero}{\mathbf{0}}
\newcommand{\bell}{\mathbf{\ell}}
\newcommand{\bpmat}{\begin{pmatrix}}
\newcommand{\epmat}{\end{pmatrix}}
\newcommand{\bbmat}{\begin{bmatrix}}
\newcommand{\ebmat}{\end{bmatrix}}
\newcommand{\bmat}{\begin{matrix}}
\newcommand{\emat}{\end{matrix}}



%%%%%%%%%%%%%%%%%%
%%% Lp spaces and operators %%%
%%%%%%%%%%%%%%%%%%
\newcommand{\Lp}[1]{L_{#1}}
\DeclarePairedDelimiterXPP\Lpmeas[2]{\Lp{#1}}{(}{)}{}{#2}
\DeclarePairedDelimiterXPP\Lpnorm[2]{}{\lVert}{\rVert}{_{\Lp{#2}}}{#1}
\DeclarePairedDelimiterXPP\Lpmeasnorm[3]{}{\lVert}{\rVert}{_{\Lpmeas{#2}{#3}}}{#1}
%\newcommand{\Lpnorm}[3][*]{\normsub#1{#2}{\Lp{#3}}}
%\newcommand{\Lpmeasnorm}[4][{-2}]{\normsub[#1]{#2}{\Lpmeas{#3}{#4}}}
\DeclarePairedDelimiterXPP\Lpinner[3]{}{\langle}{\rangle}{_{\Lp{#3}}}{#1,#2}
\DeclarePairedDelimiterXPP\Lpmeasinner[4]{}{\langle}{\rangle}{_{\Lpmeas{#3}{#4}}}{#1,#2}
%\newcommand{\Lpinner}[4][{-2}]{\innersub[#1]{#2}{#3}{\Lp{#4}}}
%\newcommand{\Lpmeasinner}[5][{-2}]{\innersub[#1]{#2}{#3}{\Lpmeas{#4}{#5}}}


%%%%%%%%%%%%%%%%%%%%%%%%
%%% Linear Algebra %%%
%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\kron}{\operatorname{\otimes}}
\newcommand{\adjsym}{\dag} % adjoint symbol
\newcommand{\adj}{^{\adjsym}} % adjoint
\DeclareMathOperator{\spec}{\sigma} % spectrum
\DeclareMathOperator{\diag}{diag} % diagonal
\DeclareMathOperator{\rank}{rank} % rank

\newcommand{\transposesym}{\top}
\newcommand{\transpose}{^{\transposesym}}
\newcommand{\invtranspose}{^{-\transposesym}}


%%%%%%%%%%%%%%%%%%%%%%%
%%% General Purpose %%%
%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\tuple}[1][]{\left\langle #1 \right\rangle}
\newcommand{\emptystr}{\text{\o}}
\newcommand{\ind}{\mathds{1}} % indicator function
\newcommand{\sgn}{\operatorname{sgn}} % sign function
\newcommand{\theset}[1]{\lbrace #1 \rbrace}
\newcommand{\sn}[2]{\ensuremath{#1\!\times\!10^{#2}}}	% #1 x 10^{#2}

\newcommand{\st}{\,:\,}
\newcommand{\given}{\mid}

% Words in math
%%%%%%%%%%%%%%%
\newcommand{\stT}{\ \text{s.t.}\ }
\newcommand{\andT}{\ \text{and}\ }
\newcommand{\orT}{\ \text{or}\ }
\newcommand{\whereT}{\ \text{where}\ }
\newcommand{\withT}{\ \text{with}\ }

% Words with special characters
%%%%%%%%%%%%%%%%
\def\cadlag{c\`adl\`ag\@\xspace}
\def\Gronwall{Gr\"onwall\xspace}
\def\Renyi{R\'enyi\xspace}
\def\Holder{H\"older\xspace}
\def\Ito{It\^o\xspace}
\def\Nystrom{Nystr\"om\xspace}
\def\Schatten{Sch\"atten\xspace}
\def\Matern{Mat\'ern\xspace}
\def\Frechet{Fr\'echet\xspace}


% New definition of square root:
% it renames \sqrt as \oldsqrt
\let\oldsqrt\sqrt
% it defines the new \sqrt in terms of the old one
\def\sqrt{\mathpalette\DHLhksqrt}
\def\DHLhksqrt#1#2{%
\setbox0=\hbox{$#1\oldsqrt{#2\,}$}\dimen0=\ht0
\advance\dimen0-0.2\ht0
\setbox2=\hbox{\vrule height\ht0 depth -\dimen0}%
{\box0\lower0.4pt\box2}}

% min and max
\def\argmax{\operatornamewithlimits{arg\,max}}
\def\argmin{\operatornamewithlimits{arg\,min}}
\def\esssup{\operatornamewithlimits{ess\,sup}}
\def\essinf{\operatornamewithlimits{ess\,inf}}

% Equality operators
\mathtoolsset{centercolon}
\newcommand{\defas}{:=}
\newcommand{\defines}{=:}
\newcommand{\xapprox}[1]{\underset{#1}{\approx}}
\newcommand{\medeq}{\!=\!}
\newcommand{\shorteq}{\!\!=\!\!}

% Other binary operators
\newcommand{\sm}{\!-\!}
\newcommand{\splus}{\!+\!}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Optimization               %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\prox}[2]{\ensuremath{\operatorname{prox}_{#1}\rbra{#2}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Convex Analysis %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareMathOperator{\cone}{cone}
\DeclareMathOperator{\conv}{conv}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Probability and Statistics %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% text shortcuts
\newcommand{\iid}{\textrm{i.i.d.}\@\xspace}
\newcommand{\as}{\textrm{a.s.}\@\xspace}
\newcommand{\aev}{\textrm{a.e.}\@\xspace}

% convergence
\newcommand{\convas}{\overset{a.s.}{\to}}
\newcommand{\convp}{\overset{p}{\to}}
\newcommand{\convd}{\overset{d}{\to}}
\newcommand{\eqd}{\overset{d}{=}}
\newcommand{\eqas}{\overset{a.s.}{=}}

% unary/functions
\renewcommand{\Pr}{\mathbb{P}}  % probability
\newcommand{\EE}{\mathbb{E}}	% expectation
\newcommand{\Law}{\mcL} 
\newcommand{\var}{\operatorname{Var}}	% variance
\newcommand{\cov}{\operatorname{Cov}}	% covariance
\newcommand{\corr}{\operatorname{Corr}}	% correlation
\newcommand{\supp}{\operatorname{supp}} %support

% binary operators
\newcommand{\distiid}{\overset{\textrm{\tiny\iid}}{\distas}}
\newcommand{\distind}{\overset{\textrm{\tiny\textrm{indep}}}{\distas}}
% maybe use these instead? can keep others for backward compatibility 
\newcommand{\distas}{\sim}
\newcommand{\distiidas}{\overset{\text{iid}}{\distas}}
\newcommand{\distindas}{\overset{\text{ind}}{\distas}}
\newcommand{\pushfwdmeas}[2]{{{#1}_{\sharp} #2}}

\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern4mu{#1#2}}}
\newcommand\indep{\protect\mathpalette{\protect\independenT}{\perp}} % independent

% parametric distributions
\newcommand{\distNamed}[1]{{\mathrm{#1}}}
\newcommand{\distNorm}{\mathcal{N}}
\newcommand{\distT}{\mathcal{T}}
\newcommand{\distWish}{\mathcal{W}}
\newcommand{\distInvWish}{\mathcal{IW}}
\newcommand{\distLap}{\distNamed{Lap}}
\newcommand{\distChiSq}{\chi^2}
\newcommand{\distUnif}{\distNamed{Unif}}
\newcommand{\distGam}{\distNamed{Gam}}
\newcommand{\distGumbel}{\distNamed{Gumbel}}
\newcommand{\distGEV}{\distNamed{GEV}}
\newcommand{\distCat}{\distNamed{Categorical}}
\newcommand{\distInvGam}{\distNamed{InvGam}}
\newcommand{\distPoiss}{\distNamed{Poiss}}
\newcommand{\distExp}{\distNamed{Exp}}
\newcommand{\distBeta}{\distNamed{Beta}}
\newcommand{\distBetaPrime}{\distNamed{Beta}'}
\newcommand{\distDir}{\distNamed{Dir}}
\newcommand{\distBinom}{\distNamed{Binom}}
\newcommand{\distMulti}{\distNamed{Multi}}
\newcommand{\distBern}{\distNamed{Bern}}
\newcommand{\distGeom}{\distNamed{Geom}}
\newcommand{\distCauchy}{\distNamed{Cauchy}}
\newcommand{\distVMF}{\distNamed{vMF}}
% nonparametric distributions
\newcommand{\distBeP}{\distNamed{BeP}}
\newcommand{\distDP}{\distNamed{DP}}
\newcommand{\distCRP}{\distNamed{CRP}}
\newcommand{\distPYP}{\distNamed{PY}}
\newcommand{\distGP}{{\distNamed{GP}}} 
\newcommand{\distPP}{\distNamed{PP}}
\newcommand{\distBP}{\distNamed{BP}}
\newcommand{\distBPP}{\distNamed{BPP}}
\newcommand{\distGamP}{\distNamed{\Gamma P}}
\newcommand{\distNGamP}{\distNamed{N\Gamma P}}
\newcommand{\distLP}{\distNamed{LP}}
\newcommand{\distObs}{\distNamed{Obs}}
\newcommand{\distCRM}{\distNamed{CRM}}
\newcommand{\distNCRM}{\distNamed{NCRM}}


%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Information Theory %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\divergence}[4][]{\mathrm{D^{\ifthenelse{\isempty{#1}}{}{#1}}_{#2}}\rbra{#3 || #4}}
\newcommand{\distance}[4][]{\mathrm{D^{\ifthenelse{\isempty{#1}}{}{#1}}_{#2}}\rbra{#3, #4}}
\newcommand{\kl}[3][]{\divergence[#1]{KL}{#2}{#3}}
\newcommand{\tvd}[3][]{\distance[#1]{TV}{#2}{#3}}
\newcommand{\ent}[1]{\mathcal{H}\rbra{#1}}
\newcommand{\hell}[3][]{\distance[#1]{H}{#2}{#3}}

%%%%%%%%%%%%%%%%%%%%%
%%% Special Funcs %%%
%%%%%%%%%%%%%%%%%%%%%
\newcommand*\pFq[2]{{}_{#1}F_{#2}}

%%%%%%%%%%%%%%%%
%%% Calculus %%%
%%%%%%%%%%%%%%%%
\newcommand{\dee}{\mathrm{d}}
\newcommand{\grad}{\nabla}

\newcommand{\der}[2]{\ensuremath{\frac{\dee #1}{\dee #2}}}
\newcommand{\dder}[2]{\ensuremath{\frac{\dee^2 #1}{\dee #2^2}}}
\newcommand{\D}[2]{\ensuremath{\frac{\partial #1}{\partial #2}}}
\newcommand{\DD}[2]{\ensuremath{\frac{\partial^2 #1}{\partial #2^2}}}
\newcommand{\Di}[2]{\ensuremath{\frac{\partial^i #1}{\partial #2^i}}}
\newcommand{\prt}[1]{\ensuremath{\frac{\partial}{\partial #1}}}
\newcommand{\hes}[2]{\ensuremath{\frac{\partial^2}{\partial #1 \partial #2}}}


%%%%%%%%%%%%%
%%% Logic %%%
%%%%%%%%%%%%%
\DeclareMathOperator{\notimplies}{\centernot\implies}


%%%%%%%%%%%%%%%%%
%%% Fractions %%%
%%%%%%%%%%%%%%%%%
\newcommand{\half}{\ensuremath{\nicefrac{1}{2}}\xspace}
\newcommand{\third}{\ensuremath{\nicefrac{1}{3}}\xspace}
\newcommand{\quarter}{\ensuremath{\nicefrac{1}{4}}\xspace}


%%%%%%%%%%%%%%%%%
%%% Shortcuts %%%
%%%%%%%%%%%%%%%%%
\newcommand{\eps}{\epsilon}
\newcommand{\veps}{\varepsilon}
\newcommand{\angles}[1]{\langle #1 \rangle}
\newcommand{\ip}[2]{\angles{#1, #2}}



%%%%%%%%%%%%%%%%%%%%%%%%
%%% Symbol shortcuts %%%
%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\charalphabetmacro}[3]{
% #1: annotation prefix
% #2: annotation command (must be a single command!)
% #3: characters to define annotations for
% Create a macros of the form
%   \newcommand{\#1##1}{#2{##1}} for each ##1 in #3
    \def\mydeffoo##1{\expandafter\def\csname #1##1\endcsname{#2{##1}}}
    \def\mydefallfoo##1{\ifx##1\mydefallfoo\else\mydeffoo##1\expandafter\mydefallfoo\fi}
    \expandafter \mydefallfoo #3\mydefallfoo
}

\newcommand{\texalphabetmacro}[3]{
% #1: annotation prefix
% #2: annotation command (must be a single command!)
% #3: latex symbol command text to define annotations for
% Create a macros of the form
%   \newcommand{\#1##1}{#2{\##1}} for each ##1 in #3
    \def\mydeftex##1{\expandafter\def\csname #1##1\endcsname{#2{\csname ##1\endcsname}}}
    \def\mydefalltex##1{\ifx\mydefalltex##1\else\mydeftex{##1}%
       \lowercase{\mydeftex{##1}}\expandafter\mydefalltex\fi}
    \expandafter \mydefalltex #3\mydefalltex
}

\newcommand{\upperCaseRomanLetters}{ABCDEFGHIJKLMNOPQRSTUVWXYZ}
\newcommand{\lowerCaseRomanLetters}{abcdefghijklmnopqrstuvwxyz}
\newcommand{\lowerCaseRomanLettersNoMHT}{abcdefgijklnopqrsuvwxyz}
\newcommand{\lowerCaseRomanLettersNoG}{abcdefhijklmnopqrstuvwxyz}
\newcommand{\lowerCaseRomanLettersNoMF}{abcdeghijklnopqrstuvwxyz}


\newcommand{\lowerCaseGreekLetters}{{alpha}{beta}{gamma}{delta}{epsilon}{zeta}{eta}{theta}{iota}{kappa}{lambda}{mu}{nu}{xi}{omicron}{pi}{rho}{sigma}{tau}{upsilon}{phi}{chi}{psi}{omega}}
\newcommand{\lowerCaseGreekLettersNoEta}{{alpha}{beta}{gamma}{delta}{epsilon}{zeta}{theta}{iota}{kappa}{lambda}{mu}{nu}{xi}{omicron}{pi}{rho}{sigma}{tau}{upsilon}{phi}{chi}{psi}{omega}}
\newcommand{\upperCaseGreekLettersInLaTeX}{{Gamma}{Delta}{Theta}{Lambda}{Xi}{Pi}{Sigma}{Upsilon}{Phi}{Psi}{Omega}}

% Bar everything shortcuts
\charalphabetmacro{bar}{\bar}{\upperCaseRomanLetters}
\charalphabetmacro{bar}{\bar}{\lowerCaseRomanLetters}

\charalphabetmacro{b}{\boldorbar}{\upperCaseRomanLetters}
\charalphabetmacro{b}{\boldorbar}{\lowerCaseRomanLettersNoMF} % avoid clash with \bm and \bf
\newcommand{\boldf}{\bm{f}} % only need \boldf, since \barf already defined above

\texalphabetmacro{b}{\boldorbar}{\lowerCaseGreekLettersNoEta} % avoid \beta <-> \bar{\eta} clash
\newcommand{\bareta}{\bar{\eta}}
\newcommand{\boldeta}{\bm{\eta}}
\texalphabetmacro{b}{\boldorbar}{\upperCaseGreekLettersInLaTeX}

% Mathcal shortcuts
\charalphabetmacro{mc}{\mathcal}{\upperCaseRomanLetters}

\newcommand{\hatmathcal}[1]{\hat{\mathcal{#1}}}
\charalphabetmacro{hmc}{\hatmathcal}{\upperCaseRomanLetters}

% Mathfrak shortcuts
\charalphabetmacro{mf}{\mathfrak}{\upperCaseRomanLetters}
\charalphabetmacro{mf}{\mathfrak}{\lowerCaseRomanLetters}


% Bold Mathfrak shortcuts
\newcommand{\boldmathfrak}[1]{\mathbf{\mathfrak{#1}}}
\charalphabetmacro{bmf}{\boldmathfrak}{\upperCaseRomanLetters}
\charalphabetmacro{bmf}{\boldmathfrak}{\lowerCaseRomanLetters}

% Hatted shortcuts
\charalphabetmacro{h}{\hat}{\upperCaseRomanLetters}
\charalphabetmacro{h}{\hat}{\lowerCaseRomanLettersNoMHT}
\texalphabetmacro{h}{\hat}{\lowerCaseGreekLetters}
\texalphabetmacro{h}{\hat}{\upperCaseGreekLettersInLaTeX}

% Bold hatted shortcuts
\newcommand{\boldhat}[1]{\mathbf{\hat{#1}}}
\charalphabetmacro{bh}{\boldhat}{\upperCaseRomanLetters}
\charalphabetmacro{bh}{\boldhat}{\lowerCaseRomanLetters}
\texalphabetmacro{bh}{\boldhat}{\lowerCaseGreekLetters}
\texalphabetmacro{bh}{\boldhat}{\upperCaseGreekLettersInLaTeX}


%Wide hatted shortcuts
\charalphabetmacro{wh}{\widehat}{\upperCaseRomanLetters}
\charalphabetmacro{wh}{\widehat}{\lowerCaseRomanLettersNoMHT}

% Tilde shortcuts 
\charalphabetmacro{td}{\tilde}{\upperCaseRomanLetters}
\charalphabetmacro{td}{\tilde}{\lowerCaseRomanLetters}
\texalphabetmacro{td}{\tilde}{\lowerCaseGreekLetters}
\texalphabetmacro{td}{\tilde}{\upperCaseGreekLettersInLaTeX}

% this had too many exceptions so i went with td instead of t :S

% Bold tilde shortcuts
\newcommand{\boldtilde}[1]{\mathbf{\tilde{#1}}}

\charalphabetmacro{btd}{\boldtilde}{\upperCaseRomanLetters}
\charalphabetmacro{btd}{\boldtilde}{\lowerCaseRomanLetters}
\texalphabetmacro{btd}{\boldtilde}{\lowerCaseGreekLetters}
\texalphabetmacro{btd}{\boldtilde}{\upperCaseGreekLettersInLaTeX}

% bold italics
\def\mathbbi#1{\textbf{\em #1}}
\charalphabetmacro{bi}{\mathbbi}{\upperCaseRomanLetters}
\charalphabetmacro{bi}{\mathbbi}{\lowerCaseRomanLettersNoG}

% bold hatted italics
\newcommand{\boldhatitalic}[1]{\hat{\mathbbi{#1}}}
\charalphabetmacro{bhi}{\boldhatitalic}{\upperCaseRomanLetters}
\charalphabetmacro{bhi}{\boldhatitalic}{\lowerCaseRomanLetters}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% New approach to symbol shortcuts %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\f}[2][]{
    \StrLeft{#1}{1}[\fontstylehead]
    \StrGobbleLeft{#1}{1}[\fontstyletail]
    \IfStrEqCase{\fontstylehead}{%
        {}{#2}
        {b}{ \mathbf{\f[\fontstyletail]{#2}} }%
        {k}{ \mathbb{\f[\fontstyletail]{#2}} }%
        {h}{ {\widehat {\f[\fontstyletail]{#2}}} }%
        }[{\f[\fontstyletail]{#2}}]
}

% commented out because it duplicates something above
% \newcommand{\upperCaseRomanLetters}{ABCDEFGHIJKLMNOPQRSTUVWXYZ} 

% essentially the same functionality as charalphabetmacro, 
% % except the macro name and the command are passed as one argument 
% % since \f is used in the definition
\newcommand{\charfontstylemacro}[2]{
% #1: annotation codes
% #2: characters to define annotations for
% Create a macros of the form
%   \newcommand{\f#1##1}{\f[#1]{##1}} for each ##1 in #2
    \def\mydeffoo##1{\expandafter\def\csname f#1##1\endcsname{\f[#1]{##1}}}
    \def\mydefallfoo##1{\ifx##1\mydefallfoo\else\mydeffoo##1\expandafter\mydefallfoo\fi}
    \expandafter \mydefallfoo #2\mydefallfoo
}

% I got this to work by basing it off of \texalphabetmacro above
% % the order of expansion in LaTeX is very opaque to me, so im not 100% 
% % sure why it works, but it does, and I wrote it thinking it would work 
% % for whatever voodoo reason \texalphabetmacro also worked.
 
\newcommand{\parsefontstylesstrings}[2]{
% #1: annotation codes
% #2: characters to define annotations for
% Create a macros of the form
%	\newcommand{\f##1##2}{\f{##1}{##2}} for each ##1 in #1 and each ##2 in #2
    \def\mydeftex##1{\expandafter\charfontstylemacro{##1}{#2}}
    \def\mydefalltex##1{\ifx\mydefalltex##1\else\mydeftex{##1}%
       \lowercase{\mydeftex{##1}}\expandafter\mydefalltex\fi}
    \expandafter \mydefalltex #1\mydefalltex
}
